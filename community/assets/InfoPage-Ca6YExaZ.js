import{c as W,a as k,h as _,ao as X,_ as B,a0 as p,ai as x,ak as T,aj as I,a1 as w,a2 as S,ad as d,a9 as g,a6 as M,al as D,r as h,X as P,a4 as b,ah as J,a7 as K,a3 as y,ap as Q,aq as R,an as V,Y as $,a8 as C,am as Z}from"./index-igPNiqby.js";import{r as z,d as F,b as Y,Q as ee,i as A,m as O,a as te}from"./ticket-DjK9-lQ_.js";import{d as G}from"./date-BdjXA3OJ.js";import{w as N,u as L}from"./user-CsLZHPLc.js";import{Q as ae,a as ne,u as U}from"./base-CiEjcQEA.js";import{u as j}from"./vue-i18n-DfA_cBGd.js";import"./format-nZn2EDmM.js";const se=W({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(t,{slots:a}){const s=k(()=>t.sent===!0?"sent":"received"),e=k(()=>`q-message-text-content q-message-text-content--${s.value}`+(t.textColor!==void 0?` text-${t.textColor}`:"")),o=k(()=>`q-message-text q-message-text--${s.value}`+(t.bgColor!==void 0?` text-${t.bgColor}`:"")),i=k(()=>"q-message-container row items-end no-wrap"+(t.sent===!0?" reverse":"")),n=k(()=>t.size!==void 0?`col-${t.size}`:""),r=k(()=>({msg:t.textHtml===!0?"innerHTML":"textContent",stamp:t.stampHtml===!0?"innerHTML":"textContent",name:t.nameHtml===!0?"innerHTML":"textContent",label:t.labelHtml===!0?"innerHTML":"textContent"}));function v(u){return a.stamp!==void 0?[u,_("div",{class:"q-message-stamp"},a.stamp())]:t.stamp?[u,_("div",{class:"q-message-stamp",[r.value.stamp]:t.stamp})]:[u]}function f(u,m){const c=m===!0?u.length>1?l=>l:l=>_("div",[l]):l=>_("div",{[r.value.msg]:l});return u.map((l,q)=>_("div",{key:q,class:o.value},[_("div",{class:e.value},v(c(l)))]))}return()=>{const u=[];a.avatar!==void 0?u.push(a.avatar()):t.avatar!==void 0&&u.push(_("img",{class:`q-message-avatar q-message-avatar--${s.value}`,src:t.avatar,"aria-hidden":"true"}));const m=[];a.name!==void 0?m.push(_("div",{class:`q-message-name q-message-name--${s.value}`},a.name())):t.name!==void 0&&m.push(_("div",{class:`q-message-name q-message-name--${s.value}`,[r.value.name]:t.name})),a.default!==void 0?m.push(f(X(a.default()),!0)):t.text!==void 0&&m.push(f(t.text)),u.push(_("div",{class:n.value},m));const c=[];return a.label!==void 0?c.push(_("div",{class:"q-message-label"},a.label())):t.label!==void 0&&c.push(_("div",{class:"q-message-label",[r.value.label]:t.label})),c.push(_("div",{class:i.value},u)),_("div",{class:`q-message q-message-${s.value}`},c)}}}),oe={__name:"ChatMessage",props:["chat"],setup(t,{expose:a}){a();function s(i){return i.split(".").pop().toString()}function e(i){window.open(i,"_blank")}const o={getFileName:s,downloadFile:e,get date(){return G}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}},ie={class:"chat"},le={key:0,class:"q-mb-sm"};function re(t,a,s,e,o,i){return p(),x("div",ie,[(p(!0),x(T,null,I(s.chat,(n,r)=>(p(),w(se,{key:r,"bg-color":n.user_id>0?"grey-3":"green-1",sent:n.user_id>0,name:n.user_id>0?"My":"Admin",stamp:e.date.formatDate(n.created_at*1e3,"MM/DD HH:mm")},{default:S(()=>[d("pre",null,g(n.content),1),n.attachment.length?(p(),x("div",le,[(p(!0),x(T,null,I(n.attachment,(v,f)=>(p(),w(M,{key:f,unelevated:"",outline:"",dense:"",class:"q-mr-sm",color:"primary",icon:"eva-eye-outline",size:"12px",label:t.$t("preview")+" "+e.getFileName(v),onClick:u=>e.downloadFile(v)},null,8,["label","onClick"]))),128))])):D("",!0)]),_:2},1032,["bg-color","sent","name","stamp"]))),128))])}const de=B(oe,[["render",re],["__scopeId","data-v-cb328aec"],["__file","ChatMessage.vue"]]),ue={__name:"ReplyMessage",props:["id"],emits:["update"],setup(t,{expose:a,emit:s}){a();const e=t,o=s,i=h(!1),n=h(),r=P({topic_id:0,content:"",attachment:[]});function v(){n.value.validate().then(m=>{m&&f()})}async function f(){i.value=!0;const m=[];for(let c=0;c<r.attachment.length;c++){const l=await U(r.attachment[c]);l.path&&m.push(l.path)}r.topic_id=e.id,r.attachment=m,z(r).then(c=>{r.attachment=[],r.content="",o("update")}).catch(c=>{y.create({position:"top",message:c.message,timeout:3e3})}).finally(()=>{i.value=!1})}const u={props:e,emit:o,loading:i,formRef:n,form:r,onSubmit:v,onReply:f,ref:h,reactive:P,get Notify(){return y},get reply(){return z},get upload(){return U}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}};function ce(t,a,s,e,o,i){return p(),w(ne,{ref:"formRef",class:"q-gutter-md q-mt-lg"},{default:S(()=>[b(J,{outlined:"",dense:"",type:"textarea",modelValue:e.form.content,"onUpdate:modelValue":a[0]||(a[0]=n=>e.form.content=n),label:t.$t("ticket_form.content"),hint:t.$t("ticket_form.content_message"),"lazy-rules":"",rules:[n=>n&&n.length>0||t.$t("ticket_form.content_message")]},null,8,["modelValue","label","hint","rules"]),b(ae,{outlined:"",dense:"",multiple:"",modelValue:e.form.attachment,"onUpdate:modelValue":a[1]||(a[1]=n=>e.form.attachment=n),label:t.$t("ticket_form.attachment"),accept:".jpg,.pdf,.png,.gif"},{append:S(()=>[b(K,{name:"eva-attach-outline",size:"16px"})]),_:1},8,["modelValue","label"]),b(M,{unelevated:"",label:t.$t("reply"),color:"primary",loading:e.loading,onClick:e.onSubmit},null,8,["label","loading"])]),_:1},512)}const me=B(ue,[["render",ce],["__file","ReplyMessage.vue"]]),E=()=>N.contract("0x6a0cd761aC978cF89F7A272aE39211c1C8CeB07D",[{inputs:[],name:"_queueId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"wallet",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"bnb",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"message",type:"bytes"}],name:"draw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"id",type:"string"}],name:"pay",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"queueQuery",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"wallet",type:"address"}],name:"setWallet",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"setupOwner",outputs:[],stateMutability:"nonpayable",type:"function"}]),H={pay(t,a){const s=E();return new Promise((e,o)=>{s.methods.pay(t).estimateGas({value:a}).then(()=>{s.methods.pay(t).send({value:a}).on("receipt",i=>{e()}).on("error",i=>{o(i.data)}).catch(i=>{o(i.data)})}).catch(i=>{o(i.data)})})},draw(t){const a=E();return new Promise((s,e)=>{a.methods.draw(t).estimateGas().then(()=>{a.methods.draw(t).send().on("receipt",o=>{s()}).on("error",o=>{e(o.data)}).catch(o=>{e(o.data)})}).catch(o=>{e(o.data)})})}},ge={__name:"ActionButton",props:["data"],emits:["update"],setup(t,{expose:a,emit:s}){a();const e=t,o=s,{t:i}=j(),n=h(!1);function r(){n.value=!0;const l=e.data.order_number_show-e.data.trade_number_show;H.pay(e.data.chain_id,N.toWei(l)).then(()=>{o("update")}).catch(q=>{y.create({position:"top",message:q.message,timeout:3e3})}).finally(()=>{n.value=!1})}function v(){n.value=!0,F(e.data.id).then(l=>{l.data.length&&f(l.data[0].trade_sign)}).catch(l=>{y.create({position:"top",message:l.message,timeout:3e3})}).finally(()=>{n.value=!1})}function f(l){n.value=!0,H.draw(l).then(()=>{o("update")}).catch(q=>{y.create({position:"top",message:q.message,timeout:3e3})}).finally(()=>{n.value=!1})}function u(){Q.create({title:i("confirm"),message:i("delete_message"),cancel:!0,persistent:!0}).onOk(()=>{m()})}function m(){n.value=!0,Y(e.data.id).then(l=>{o("update")}).catch(l=>{y.create({position:"top",message:l.message,timeout:3e3})}).finally(()=>{n.value=!1})}const c={props:e,emit:o,t:i,loading:n,onPay:r,onDraw:v,onContractDraw:f,onDeleteConfim:u,onDelete:m,ref:h,get Notify(){return y},get Dialog(){return Q},get useI18n(){return j},get draw(){return F},get del(){return Y},get payContract(){return H},get web3(){return N}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}};function _e(t,a,s,e,o,i){return p(),x(T,null,[s.data.status==0?(p(),w(M,{key:0,unelevated:"",class:"q-mt-lg full-width",label:t.$t("ticket_pay",{amount:s.data.order_number_show-s.data.trade_number_show}),color:"primary",loading:e.loading,onClick:e.onPay},null,8,["label","loading"])):D("",!0),s.data.refund_status==0?(p(),w(M,{key:1,unelevated:"",class:"q-mt-lg full-width",label:t.$t("ticket_draw",{amount:s.data.trade_number_show}),color:"positive",loading:e.loading,onClick:e.onDraw},null,8,["label","loading"])):D("",!0),s.data.status<1?(p(),w(M,{key:2,outline:"",class:"q-mt-lg full-width",label:t.$t("delete"),color:"dark",loading:e.loading,onClick:e.onDeleteConfim},null,8,["label","loading"])):D("",!0)],64)}const fe=B(ge,[["render",_e],["__file","ActionButton.vue"]]),pe={__name:"InfoPage",setup(t,{expose:a}){a();const s=R(),e=V(),o=h(!0),i=h({}),n=h([]),r=h(0);function v(c=!0){c&&(o.value=!0),A(r.value).then(l=>{i.value=l.data,f()}).catch(l=>{y.create({position:"top",message:l.message,timeout:3e3}),e.push("/")}).finally(()=>{o.value=!1})}function f(){O(i.value.id).then(c=>{n.value=c.data})}L.on(()=>{r.value=s.params.id,v()}),$(()=>{clearInterval(u)});const u=setInterval(()=>{v(!1)},1e4),m={route:s,router:e,loading:o,data:i,chat:n,id:r,getData:v,getMessage:f,timer:u,get date(){return G},get Notify(){return y},ref:h,onUnmounted:$,get useRoute(){return R},get useRouter(){return V},get info(){return A},get message(){return O},get userModel(){return L},ChatMessage:de,ReplyMessage:me,ActionButton:fe};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}},ve={class:"box"},he={class:"title"},ye={class:"row q-col-gutter-lg"},be={class:"col-sm-5 col-xs-12"},we={class:"info"},Ce={class:"item"},ke={class:"name"},Me={class:"item"},qe={class:"name"},xe={class:"item"},De={class:"name"},Se={class:"item"},Be={class:"name"},He={class:"name"},Te={class:"item"},Ne={class:"name"},Ie={class:"item"},Pe={class:"name"},Qe={class:"col-sm-7 col-xs-12"};function Re(t,a,s,e,o,i){return p(),w(ee,{class:"q-pa-md"},{default:S(()=>[d("div",ve,[b(M,{flat:"",dense:"",class:"q-mb-sm text-blue-grey-3",icon:"eva-arrow-back-outline",onClick:a[0]||(a[0]=n=>t.$router.push("/"))}),d("div",he,g(e.data.title??"..."),1),d("div",ye,[d("div",be,[d("div",we,[d("div",Ce,[d("div",ke,g(t.$t("ticket_form.email")),1),C(" "+g(e.data.email??"..."),1)]),d("div",Me,[d("div",qe,g(t.$t("ticket_form.telegram")),1),C(" "+g(e.data.telegram??"..."),1)]),d("div",xe,[d("div",De,g(t.$t("ticket_form.created_at")),1),C(" "+g(e.date.formatDate(e.data.created_at*1e3,"YYYY/MM/DD HH:mm")),1)]),d("div",Se,[d("div",Be,g(t.$t("ticket_form.updated_at")),1),C(" "+g(e.date.formatDate(e.data.updated_at*1e3,"YYYY/MM/DD HH:mm")),1)]),d("div",{class:Z(["item",{wait:e.data.status==0,paid:e.data.status==1}])},[d("div",He,g(t.$t("ticket_form.status")),1),C(" "+g(t.$t("ticket_form.status_text."+(e.data.status??-1))),1)],2),d("div",Te,[d("div",Ne,g(t.$t("ticket_form.order_number")),1),C(" "+g(e.data.order_number_show)+" BNB ",1)]),d("div",Ie,[d("div",Pe,g(t.$t("ticket_form.trade_number")),1),C(" "+g(e.data.trade_number_show)+" BNB ",1)])]),b(e.ActionButton,{data:e.data,onUpdate:a[1]||(a[1]=n=>e.getData(!1))},null,8,["data"]),e.data.status>0?(p(),w(e.ReplyMessage,{key:0,id:e.data.id,onUpdate:a[2]||(a[2]=n=>e.getData(!1))},null,8,["id"])):D("",!0)]),d("div",Qe,[b(e.ChatMessage,{chat:e.chat},null,8,["chat"])])]),b(te,{showing:e.loading},null,8,["showing"])])]),_:1})}const Le=B(pe,[["render",Re],["__scopeId","data-v-3ba21397"],["__file","InfoPage.vue"]]);export{Le as default};
