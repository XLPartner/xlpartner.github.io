import{c as w,av as X,aw as Y,a as d,L as G,h as x,a4 as $,ax as H,a7 as J,t as I,g as E,r as R,G as Z,B as ee,ay as te,F as ne,y as le,az as ie,o as ae,d as oe,z as ue,f as re,M as se,aA as ce}from"./index-DpWqg_i-.js";import{u as de,a as fe,h as ve}from"./format-BMZ7R8hP.js";import{u as me,c as ge,e as he,f as be,g as ye,h as Se,j as xe,k as K,l as Fe}from"./ticket-CCFfdIsS.js";const Ce={xs:8,sm:10,md:14,lg:20,xl:24},pe=w({name:"QChip",props:{...de,...X,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:m,emit:S}){const{proxy:{$q:F}}=E(),u=fe(e,F),c=Y(e,Ce),f=d(()=>e.selected===!0||e.icon!==void 0),q=d(()=>e.selected===!0?e.iconSelected||F.iconSet.chip.selected:e.icon),V=d(()=>e.iconRemove||F.iconSet.chip.remove),k=d(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),P=d(()=>{const n=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(n?` text-${n} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(k.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(u.value===!0?" q-chip--dark q-dark":"")}),p=d(()=>{const n=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},_={...n,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||F.lang.label.remove};return{chip:n,remove:_}});function A(n){n.keyCode===13&&l(n)}function l(n){e.disable||(S("update:selected",!e.selected),S("click",n))}function h(n){(n.keyCode===void 0||n.keyCode===13)&&(I(n),e.disable===!1&&(S("update:modelValue",!1),S("remove")))}function r(){const n=[];k.value===!0&&n.push(x("div",{class:"q-focus-helper"})),f.value===!0&&n.push(x($,{class:"q-chip__icon q-chip__icon--left",name:q.value}));const _=e.label!==void 0?[x("div",{class:"ellipsis"},[e.label])]:void 0;return n.push(x("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},H(m.default,_))),e.iconRight&&n.push(x($,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&n.push(x($,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:V.value,...p.value.remove,onClick:h,onKeyup:h})),n}return()=>{if(e.modelValue===!1)return;const n={class:P.value,style:c.value};return k.value===!0&&Object.assign(n,p.value.chip,{onClick:l,onKeyup:A}),G("div",n,r(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[J,e.ripple]])}}});function D(e,m,S,F){const u=[];return e.forEach(c=>{F(c)===!0?u.push(c):m.push({failedPropValidation:S,file:c})}),u}function N(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),I(e)}const qe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ke=["rejected"];function _e({editable:e,dnd:m,getFileInput:S,addFilesToQueue:F}){const{props:u,emit:c,proxy:f}=E(),q=R(null),V=d(()=>u.accept!==void 0?u.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),k=d(()=>parseInt(u.maxFiles,10)),P=d(()=>parseInt(u.maxTotalSize,10));function p(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&Z(t);else{const o=S();o&&o!==t.target&&o.click(t)}}function A(t){e.value&&t&&F(null,t)}function l(t,o,v,b){let a=Array.from(o||t.target.files);const y=[],j=()=>{y.length!==0&&c("rejected",y)};if(u.accept!==void 0&&V.value.indexOf("*/")===-1&&(a=D(a,y,"accept",s=>V.value.some(g=>s.type.toUpperCase().startsWith(g)||s.name.toUpperCase().endsWith(g))),a.length===0))return j();if(u.maxFileSize!==void 0){const s=parseInt(u.maxFileSize,10);if(a=D(a,y,"max-file-size",g=>g.size<=s),a.length===0)return j()}if(u.multiple!==!0&&a.length!==0&&(a=[a[0]]),a.forEach(s=>{s.__key=s.webkitRelativePath+s.lastModified+s.name+s.size}),b===!0){const s=v.map(g=>g.__key);a=D(a,y,"duplicate",g=>s.includes(g.__key)===!1)}if(a.length===0)return j();if(u.maxTotalSize!==void 0){let s=b===!0?v.reduce((g,O)=>g+O.size,0):0;if(a=D(a,y,"max-total-size",g=>(s+=g.size,s<=P.value)),a.length===0)return j()}if(typeof u.filter=="function"){const s=u.filter(a);a=D(a,y,"filter",g=>s.includes(g))}if(u.maxFiles!==void 0){let s=b===!0?v.length:0;if(a=D(a,y,"max-files",()=>(s++,s<=k.value)),a.length===0)return j()}if(j(),a.length!==0)return a}function h(t){N(t),m.value!==!0&&(m.value=!0)}function r(t){I(t),(t.relatedTarget!==null||ee.is.safari!==!0?t.relatedTarget!==q.value:document.elementsFromPoint(t.clientX,t.clientY).includes(q.value)===!1)===!0&&(m.value=!1)}function n(t){N(t);const o=t.dataTransfer.files;o.length!==0&&F(null,o),m.value=!1}function _(t){if(m.value===!0)return x("div",{ref:q,class:`q-${t}__dnd absolute-full`,onDragenter:N,onDragover:N,onDragleave:r,onDrop:n})}return Object.assign(f,{pickFiles:p,addFiles:A}),{pickFiles:p,addFiles:A,onDragover:h,onDragleave:r,processFiles:l,getDndNode:_,maxFilesNumber:k,maxTotalSizeNumber:P}}const Ae=w({name:"QFile",inheritAttrs:!1,props:{...me,...ge,...qe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...he,...ke],setup(e,{slots:m,emit:S,attrs:F}){const{proxy:u}=E(),c=be(),f=R(null),q=R(!1),V=ye(e),{pickFiles:k,onDragover:P,onDragleave:p,processFiles:A,getDndNode:l}=_e({editable:c.editable,dnd:q,getFileInput:Q,addFilesToQueue:L}),h=Se(e),r=d(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),n=d(()=>K(r.value)),_=d(()=>r.value.map(i=>i.name).join(", ")),t=d(()=>ve(r.value.reduce((i,C)=>i+C.size,0))),o=d(()=>({totalSize:t.value,filesNumber:r.value.length,maxFiles:e.maxFiles})),v=d(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:V.value,...F,id:c.targetUid.value,disabled:c.editable.value!==!0})),b=d(()=>"q-file q-field--auto-height"+(q.value===!0?" q-file--dnd":"")),a=d(()=>e.multiple===!0&&e.append===!0);function y(i){const C=r.value.slice();C.splice(i,1),s(C)}function j(i){const C=r.value.indexOf(i);C!==-1&&y(C)}function s(i){S("update:modelValue",e.multiple===!0?i:i[0])}function g(i){i.keyCode===13&&ne(i)}function O(i){(i.keyCode===13||i.keyCode===32)&&k(i)}function Q(){return f.value}function L(i,C){const z=A(i,C,r.value,a.value),T=Q();T!=null&&(T.value=""),z!==void 0&&((e.multiple===!0?e.modelValue&&z.every(W=>r.value.includes(W)):e.modelValue===z[0])||s(a.value===!0?r.value.concat(z):z))}function B(){return[x("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function M(){if(m.file!==void 0)return r.value.length===0?B():r.value.map((C,z)=>m.file({index:z,file:C,ref:this}));if(m.selected!==void 0)return r.value.length===0?B():m.selected({files:r.value,ref:this});if(e.useChips===!0)return r.value.length===0?B():r.value.map((C,z)=>x(pe,{key:"file-"+z,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{y(z)}},()=>x("span",{class:"ellipsis",textContent:C.name})));const i=e.displayValue!==void 0?e.displayValue:_.value;return i.length!==0?[x("div",{class:e.inputClass,style:e.inputStyle,textContent:i})]:B()}function U(){const i={ref:f,...v.value,...h.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:L};return e.multiple===!0&&(i.multiple=!0),x("input",i)}return Object.assign(c,{fieldClass:b,emitValue:s,hasValue:n,inputRef:f,innerValue:r,floatingLabel:d(()=>n.value===!0||K(e.displayValue)),computedCounter:d(()=>{if(e.counterLabel!==void 0)return e.counterLabel(o.value);const i=e.maxFiles;return`${r.value.length}${i!==void 0?" / "+i:""} (${t.value})`}),getControlChild:()=>l("file"),getControl:()=>{const i={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(i,{onDragover:P,onDragleave:p,onKeydown:g,onKeyup:O}),x("div",i,[U()].concat(M()))}}),Object.assign(u,{removeAtIndex:y,removeFile:j,getNativeElement:()=>f.value}),te(u,"nativeEl",()=>f.value),xe(c)}}),je=w({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:m,emit:S}){const F=E(),u=R(null);let c=0;const f=[];function q(l){const h=typeof l=="boolean"?l:e.noErrorFocus!==!0,r=++c,n=(o,v)=>{S(`validation${o===!0?"Success":"Error"}`,v)},_=o=>{const v=o.validate();return typeof v.then=="function"?v.then(b=>({valid:b,comp:o}),b=>({valid:!1,comp:o,err:b})):Promise.resolve({valid:v,comp:o})};return(e.greedy===!0?Promise.all(f.map(_)).then(o=>o.filter(v=>v.valid!==!0)):f.reduce((o,v)=>o.then(()=>_(v).then(b=>{if(b.valid===!1)return Promise.reject(b)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return r===c&&n(!0),!0;if(r===c){const{comp:v,err:b}=o[0];if(b!==void 0&&console.error(b),n(!1,v),h===!0){const a=o.find(({comp:y})=>typeof y.focus=="function"&&ue(y.$)===!1);a!==void 0&&a.comp.focus()}}return!1})}function V(){c++,f.forEach(l=>{typeof l.resetValidation=="function"&&l.resetValidation()})}function k(l){l!==void 0&&I(l);const h=c+1;q().then(r=>{h===c&&r===!0&&(e.onSubmit!==void 0?S("submit",l):l!==void 0&&l.target!==void 0&&typeof l.target.submit=="function"&&l.target.submit())})}function P(l){l!==void 0&&I(l),S("reset"),re(()=>{V(),e.autofocus===!0&&e.noResetFocus!==!0&&p()})}function p(){Fe(()=>{if(u.value===null)return;const l=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),h=>h.tabIndex!==-1);l?.focus({preventScroll:!0})})}se(ce,{bindComponent(l){f.push(l)},unbindComponent(l){const h=f.indexOf(l);h!==-1&&f.splice(h,1)}});let A=!1;return le(()=>{A=!0}),ie(()=>{A===!0&&e.autofocus===!0&&p()}),ae(()=>{e.autofocus===!0&&p()}),Object.assign(F.proxy,{validate:q,resetValidation:V,submit:k,reset:P,focus:p,getValidationComponents:()=>f}),()=>x("form",{class:"q-form",ref:u,onSubmit:k,onReset:P},oe(m.default))}});export{Ae as Q,je as a};
